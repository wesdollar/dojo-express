// Prisma schema docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model Dashboard {
  id           Int           @id @default(autoincrement())
  name         String
  isActive     Boolean       @default(true)
  phoneNumbers PhoneNumber[]
  calls        Call[]
  users        User[]
  createdAt    DateTime      @default(now())
  updatedAt    DateTime      @updatedAt
}

model Call {
  id                    Int        @id @default(autoincrement())
  twilioSid             String     @unique
  dateCreated           String?
  dateUpdated           String?
  twilioAccountSid      String
  calledNumber          String
  calledNumberFormatted String?
  phoneNumberSid        String?
  startTime             DateTime?
  endTime               DateTime?
  duration              Int?
  price                 Decimal?
  priceUnit             String?
  answeredBy            String?
  twilioUri             String?    @unique
  createdAt             DateTime   @default(now())
  updatedAt             DateTime   @updatedAt
  dashboard             Dashboard  @relation(fields: [dashboardId], references: [id])
  dashboardId           Int
  caller                Caller     @relation(fields: [callerId], references: [id])
  callerId              Int
  callStatus            CallStatus @relation(fields: [callStatusId], references: [id])
  callStatusId          Int
}

model User {
  id         Int         @id @default(autoincrement())
  firstName  String
  lastName   String
  email      String      @unique
  dashboards Dashboard[]
  createdAt  DateTime    @default(now())
  updatedAt  DateTime    @updatedAt
}

model Caller {
  id              Int      @id @default(autoincrement())
  number          String
  numberFormatted String?
  name            String?
  country         String?
  state           String?
  city            String?
  zip             String?
  isBlocked       Boolean  @default(false)
  calls           Call[]
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
}

model PhoneNumber {
  id               Int        @id @default(autoincrement())
  twilioSid        String     @unique
  twilioAccountSid String
  nickname         String
  phoneNumber      String
  createdAt        DateTime   @default(now())
  updatedAt        DateTime   @updatedAt
  Dashboard        Dashboard? @relation(fields: [dashboardId], references: [id])
  dashboardId      Int?
}

model CallStatus {
  id     Int    @id @default(autoincrement())
  status String
  Call   Call[]
}
